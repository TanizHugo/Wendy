(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7692e389"],{"06cfc":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"filter-container"},[t._m(0),o("div",{staticClass:"filter-right"},[o("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{placeholder:"订单类型",clearable:""},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},t._l(t.statusOptions,(function(t){return o("el-option",{key:t,attrs:{label:t,value:t}})})),1),o("el-input",{staticClass:"filter-item",staticStyle:{width:"200px","margin-left":"10px"},attrs:{placeholder:"订单编号："},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.oid,callback:function(e){t.$set(t.listQuery,"oid",e)},expression:"listQuery.oid"}}),o("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:""},on:{click:t.handleFilter}},[t._v(" 查询 ")]),o("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-refresh-right",plain:""},on:{click:t.handleRefresh}},[t._v(" 刷新 ")])],1)]),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{"border-radius":"10px"},attrs:{data:t.list,"element-loading-text":"Loading",fit:"","highlight-current-row":"","header-cell-style":{background:"#f5f7fa",color:"#606266"}}},[o("el-table-column",{attrs:{align:"center",label:"订单编号",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.order_info.oid)+" ")]}}])}),o("el-table-column",{attrs:{align:"center",label:"商品名"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.stock_info.stock_name)+" ")]}}])}),o("el-table-column",{attrs:{label:"总价",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.order_info.pay))])]}}])}),o("el-table-column",{attrs:{label:"预计收货时间",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDate")(e.row.order_info.book_time,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])}),o("el-table-column",{attrs:{label:"收货时间",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDate")(e.row.order_info.finish_time,"yyyy-MM-dd hh:mm:ss"))+" ")]}}])}),o("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.order_info.state)+" ")]}}])}),o("el-table-column",{attrs:{align:"center",prop:"created_at",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-dropdown",[o("el-button",{attrs:{size:"small",plain:""}},[t._v(" 操作"),o("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{nativeOn:{click:function(o){return t.handleShow(e.row.order_info.oid)}}},[t._v("查看详情")]),o("el-dropdown-item",{nativeOn:{click:function(o){return t.handleUpdate(e.row.order_info.oid,e.row.order_info.state)}}},[t._v("修改信息")]),o("el-dropdown-item",{nativeOn:{click:function(o){return t.handleUpdateStatus(e.row.order_info.oid,e.row.order_info.state)}}},[t._v("修改订单状态")])],1)],1)]}}])})],1),o("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],attrs:{total:t.total,page:t.listQuery.page,page_size:t.listQuery.page_size},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:page_size":function(e){return t.$set(t.listQuery,"page_size",e)},pagination:t.getOrder}}),o("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{ref:"dataForm",attrs:{model:t.temp,rules:t.rules,"label-position":"left","label-width":"80px"}},[o("el-row",[o("el-col",{attrs:{span:8,offset:2}},[o("el-form-item",{attrs:{label:"订单号"}},[t._v(" "+t._s(t.temp.order_info.oid)+" ")])],1),o("el-col",{attrs:{span:10,offset:2}},[o("el-form-item",{attrs:{label:"下单时间"}},[t._v(" "+t._s(t.temp.order_info.create_time)+" ")])],1)],1),o("el-row",{attrs:{"v-model":t.temp.stock_info}},t._l(t.temp.stock_info,(function(e,a){return o("div",{key:a},[o("el-col",{attrs:{span:8,offset:2}},[o("el-form-item",{attrs:{label:"商品编号"}},[t._v(" "+t._s(e.sid)+" ")])],1),o("el-col",{attrs:{span:8,offset:2}},[o("el-form-item",{attrs:{label:"商品名字"}},[t._v(" "+t._s(e.stock_name)+" ")])],1)],1)})),0),o("el-row",[o("el-col",{attrs:{span:8,offset:2}},[o("el-form-item",{attrs:{label:"数量"}},[t._v(" "+t._s(t.temp.order_info.quantity)+" ")])],1),o("el-col",{attrs:{span:10,offset:2}},["show"==t.dialogStatus?o("el-form-item",{attrs:{label:"预约取件时间","label-width":"100px"}},[t._v(" "+t._s(t._f("formatDate")(t.temp.order_info.book_time,"yyyy-MM-dd hh:mm:ss"))+" ")]):o("el-form-item",{attrs:{label:"预约取件时间","label-width":"100px"}},[o("el-date-picker",{attrs:{"value-format":"timestamp",type:"datetime",placeholder:"选择日期"},on:{change:t.upTime},model:{value:t.book_time,callback:function(e){t.book_time=e},expression:"book_time"}})],1)],1)],1),o("el-row"),o("el-row",[o("el-col",{attrs:{span:8,offset:2}},[o("el-form-item",{attrs:{label:"收货人"}},[t._v(" "+t._s(t.temp.order_info.user_name)+" ")])],1),o("el-col",{attrs:{span:10,offset:2}},[o("el-form-item",{attrs:{label:"总价"}},[t._v(" "+t._s(t.temp.order_info.pay)+" ")])],1)],1),o("el-row",[o("el-col",{attrs:{span:8,offset:2}},[o("el-form-item",{attrs:{label:"联系方式"}},[t._v(" "+t._s(t.temp.order_info.phone)+" ")])],1),o("el-col",{attrs:{span:10,offset:2}},[o("el-form-item",{attrs:{label:"订单状态"}},[t._v(" "+t._s(t.temp.order_info.state)+" ")])],1)],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["show"!=t.dialogStatus?o("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.updateData()}}},[t._v("提交")]):t._e(),o("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")])],1)],1),o("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.statusDialog},on:{"update:visible":function(e){t.statusDialog=e}}},[o("div",[t._v("当前订单状态："+t._s(t.temp.order_info.state))]),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["show"!=t.dialogStatus?o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.choiceData(4,t.temp.order_info.oid)}}},[t._v("已收货")]):t._e(),"show"!=t.dialogStatus?o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.choiceData(5,t.temp.order_info.oid)}}},[t._v("取消订单 ")]):t._e(),o("el-button",{on:{click:function(e){t.statusDialog=!1}}},[t._v("取消")])],1)])],1)},i=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"ordertext"},[t._v("历史订单状态")])])}],n=(o("4de4"),o("d3b7"),o("ac1f"),o("5319"),o("f8b7")),r=o("6724"),s=o("333d"),l=(o("61f7"),o("2f62"),function(t){return t<10?"0"+t:t}),d={name:"orderControl",components:{Pagination:s["a"]},directives:{waves:r["a"]},inject:["reload"],filters:{formatDate:function(t){if(0==t)return"无";var e=new Date(1e3*t),o=e.getFullYear(),a=l(e.getMonth()+1),i=l(e.getDate()),n=l(e.getHours()),r=l(e.getMinutes()),s=l(e.getSeconds());return o+"-"+a+"-"+i+" "+n+":"+r+":"+s}},data:function(){return{list:null,total:0,listLoading:!0,loading:!1,listQuery:{page:1,page_size:10,state:"",oid:"",mid:""},state:"",temp:{order_info:{},stock_info:{},merchant_info:{}},dialogFormVisible:!1,dialogStatus:"",statusOptions:["已接单","已拒接","已签收","已退单"],textMap:{updateOrder:"修改订单",show:"查看详情",updateStatus:"修改订单状态"},rules:{},dialogPvVisible:!1,pvData:[],downloadLoading:!1,statusDialog:!1,choiceStatus:{state:0,oid:0},mid:"",book_time:""}},created:function(){this.getOrder()},methods:{getOrder:function(){var t=this;this.stateIn(),this.mid=sessionStorage.getItem("mid"),this.listQuery.mid=this.mid,console.log("this.listQuery",this.listQuery),this.listLoading=!0,Object(n["a"])(this.listQuery).then((function(e){var o=e.data.data;t.total=e.data.total,console.log("list.order_info",o);var a=o.filter((function(t){return 1!=t.order_info.state}));t.stateUp(a),console.log("list1",a),t.list=a,t.listLoading=!1,console.log(t.list)})).catch((function(e){t.listLoading=!1}))},handleFilter:function(){this.listQuery.page=1,this.getOrder()},resetTemp:function(){this.temp={order_info:{},stock_info:{},merchant_info:{}}},handleShow:function(t){var e=this,o=this;console.log(t),o.resetTemp();var a={};a.oid=t,Object(n["b"])(a).then((function(t){var a=t.data.data;console.log("response,",a),o.listLoading=!1;for(var i={},n=[],r=0;r<a.length;r++){var s=a[r];if(console.log(s),i[s.order_info.oid])for(var l=0;l<n.length;l++){var d=n[l];if(d.order_info.oid==s.order_info.oid){d.stock_info.push(s.stock_info);break}}else n.push({merchant_info:s.merchant_info,order_info:s.order_info,stock_info:[s.stock_info]}),i[s.order_info.oid]=s}console.log(n,e.temp),o.stateUp(a),n[0].order_info.create_time=n[0].order_info.create_time.toLocaleString().replace(/T/g," ").replace(/\.[\d]{3}Z/,""),o.temp=n[0],console.log(n),console.log(t.data)})),o.dialogStatus="show",o.dialogFormVisible=!0},handleUpdate:function(t,e){var o=this,a=this;if("已接单"!=e)this.$message({type:"info",message:"此订单不支持修改订单信息"});else{a.resetTemp();var i={};i.oid=t,Object(n["b"])(i).then((function(t){var e=t.data.data;console.log("response,",e),a.listLoading=!1;for(var o={},i=[],n=0;n<e.length;n++){var r=e[n];if(console.log(r),o[r.order_info.oid])for(var s=0;s<i.length;s++){var l=i[s];if(l.order_info.oid==r.order_info.oid){l.stock_info.push(r.stock_info);break}}else i.push({merchant_info:r.merchant_info,order_info:r.order_info,stock_info:[r.stock_info]}),o[r.order_info.oid]=r}a.stateUp(i),a.temp=i[0],console.log("that.temp",i)})),this.dialogStatus="updateOrder",this.dialogFormVisible=!0,this.$nextTick((function(){o.$refs["dataForm"].clearValidate()}))}},updateData:function(){var t=this;this.loading=!0,this.$refs.dataForm.validate((function(e){if(t.dialogFormVisible=!1,!e)return console.log("修改失败!!"),!1;var o={};o.oid=t.temp.order_info.oid,o.book_time=t.temp.order_info.book_time,Object(n["c"])(o).then((function(){t.loading=!1,t.dialogFormVisible=!1,t.reload(),t.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3})}))}))},upTime:function(t){console.log(t),this.temp.order_info.book_time=t/1e3},handleUpdateStatus:function(t,e){var o=this,a=this;if("已接单"!=e)this.$message({type:"info",message:"此订单不支持修改订单状态"});else{a.resetTemp();var i={};i.oid=t,Object(n["b"])(i).then((function(t){var e=t.data.data;console.log("response,",e),a.listLoading=!1;for(var o={},i=[],n=0;n<e.length;n++){var r=e[n];if(console.log(r),o[r.order_info.oid])for(var s=0;s<i.length;s++){var l=i[s];if(l.order_info.oid==r.order_info.oid){l.stock_info.push(r.stock_info);break}}else i.push({merchant_info:r.merchant_info,order_info:r.order_info,stock_info:[r.stock_info]}),o[r.order_info.oid]=r}a.stateUp(i),a.temp=i[0],console.log(i)})),this.dialogStatus="updateStatus",this.statusDialog=!0,this.$nextTick((function(){o.$refs["dataForm"].clearValidate()}))}},choiceData:function(t,e){var o=this;this.choiceStatus.state=t,this.choiceStatus.oid=e,this.statusDialog=!1,Object(n["d"])(this.choiceStatus).then((function(t){o.dialogFormVisible=!1,console.log(t),o.reload(),o.$notify({title:"成功",message:t.message,type:"success",duration:2e3})}))},handleRefresh:function(){this.reload()},stateUp:function(t){for(var e=0;e<t.length;e++)switch(t[e].order_info.state){case 1:t[e].order_info.state="未接单";break;case 2:t[e].order_info.state="已接单";break;case 3:t[e].order_info.state="已拒收";break;case 4:t[e].order_info.state="已签收";break;case 5:t[e].order_info.state="已退单";break;default:console.log("default")}},stateIn:function(){var t=this.state;switch(t){case"未接单":this.listQuery.state=1;break;case"已接单":this.listQuery.state=2;break;case"已拒接":this.listQuery.state=3;break;case"已签收":this.listQuery.state=4;break;case"已退单":this.listQuery.state=5;break;default:console.log("default")}}}},c=d,u=(o("afba"),o("2877")),f=Object(u["a"])(c,a,i,!1,null,"3f337f05",null);e["default"]=f.exports},"0e5d":function(t,e,o){},"333d":function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[o("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},i=[];o("a9e3");Math.easeInOutQuad=function(t,e,o,a){return t/=a/2,t<1?o/2*t*t+e:(t--,-o/2*(t*(t-2)-1)+e)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function r(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(t,e,o){var a=s(),i=t-a,l=20,d=0;e="undefined"===typeof e?500:e;var c=function t(){d+=l;var s=Math.easeInOutQuad(d,a,i,e);r(s),d<e?n(t):o&&"function"===typeof o&&o()};c()}var d={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&l(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&l(0,800)}}},c=d,u=(o("5660"),o("2877")),f=Object(u["a"])(c,a,i,!1,null,"6af373ef",null);e["a"]=f.exports},5660:function(t,e,o){"use strict";o("7a30")},6724:function(t,e,o){"use strict";o("8d41");var a="@@wavesContext";function i(t,e){function o(o){var a=Object.assign({},e.value),i=Object.assign({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),n=i.ele;if(n){n.style.position="relative",n.style.overflow="hidden";var r=n.getBoundingClientRect(),s=n.querySelector(".waves-ripple");switch(s?s.className="waves-ripple":(s=document.createElement("span"),s.className="waves-ripple",s.style.height=s.style.width=Math.max(r.width,r.height)+"px",n.appendChild(s)),i.type){case"center":s.style.top=r.height/2-s.offsetHeight/2+"px",s.style.left=r.width/2-s.offsetWidth/2+"px";break;default:s.style.top=(o.pageY-r.top-s.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",s.style.left=(o.pageX-r.left-s.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return s.style.backgroundColor=i.color,s.className="waves-ripple z-active",!1}}return t[a]?t[a].removeHandle=o:t[a]={removeHandle:o},o}var n={bind:function(t,e){t.addEventListener("click",i(t,e),!1)},update:function(t,e){t.removeEventListener("click",t[a].removeHandle,!1),t.addEventListener("click",i(t,e),!1)},unbind:function(t){t.removeEventListener("click",t[a].removeHandle,!1),t[a]=null,delete t[a]}},r=function(t){t.directive("waves",n)};window.Vue&&(window.waves=n,Vue.use(r)),n.install=r;e["a"]=n},"7a30":function(t,e,o){},"8d41":function(t,e,o){},afba:function(t,e,o){"use strict";o("0e5d")},f8b7:function(t,e,o){"use strict";o.d(e,"a",(function(){return i})),o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return r})),o.d(e,"d",(function(){return s}));var a=o("b775");function i(t){return console.log(t),Object(a["a"])({url:"/order",method:"get",params:t})}function n(t){return Object(a["a"])({url:"/order",method:"get",params:t})}function r(t){return Object(a["a"])({url:"/order",method:"put",data:t})}function s(t){return Object(a["a"])({url:"/order",method:"put",data:t})}}}]);